# Windows Privilege Escalation Exploits

[Service Escalation Registry (regsvc)](https://github.com/KaminoSec/windows_privesc/tree/main/service_escalation_registry) : Using Get-Acl we determine that the NT AUTHORITY\INTERACTIVE has full control over the regsvc registry. We can then add a malicious executable to the registry service and leverage this exploit to either get a reverse shell or add a user.

[SeImpersonate Potato Attack](https://github.com/KaminoSec/windows_privesc/tree/main/impersonation_potato_attack): Legitimate programs may utilize another process's token to escalate from Administrator to Local System, which has additional privileges. Processes generally do this by making a call to the `WinLogon` process to get a `SYSTEM` token, then executing itself with that token placing it within the SYSTEM space. Attackers often abuse this privilege in the "Potato style" privesc, where a service account can `SeImpersonate`, but not obtain full SYSTEM level privileges.

[Autorun Logon Registry](https://github.com/KaminoSec/windows_privesc/tree/main/impersonation_potato_attack): Running Autoruns.exe from [Sysinternals](https://learn.microsoft.com/en-us/sysinternals/downloads/autorun) we can view which programs that run from the autorun registry keys or folders. This tool also provides insight into Scheduled Tasks, Services, WinLogon, DLLS, and more.

[AlwaysInstallElevated Registry](https://github.com/KaminoSec/windows_privesc/tree/main/always_install_elevated): AlwaysInstallElevated is a registry key entry in the **`HKLM\Software\Policies\Microsoft\Windows\Installer`** and **`HKCU\Software\Policies\Microsoft\Windows\Installer`** registry keys that allows any user to install an .msi file with elevated privileges.

[Service Escalation Executables](https://github.com/KaminoSec/windows_privesc/tree/main/service_escalation_executables): When we find services running that have executables attached to them, we want to check if they are running with "FILE ALL ACCESS" permissions for "Everyone". This can be exploited to get a reverse shell or add a user to the local administrators group. We can detect this vulnerability using SysInternals accesschk64.exe or PowerUp.ps1. Using the PowerUp.ps1 option will provide better detail and not require the direct run against a specific program.

[Startup Applications](https://github.com/KaminoSec/windows_privesc/tree/main/startup_applications): We can run icacls.exe to check and see if our current user has write access to the "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup" directory. If this privilege exists we can add a malicous executable that will give us an elevated shell once an user with administrator privileges logs on to the target machine.

[DLL Hijacking](https://github.com/KaminoSec/windows_privesc/tree/main/dll_hijacking): DLL hijacking looks for a specific applications fails to load a DLL file due to the intended/valid file not being found (”NAME NOT FOUND”). By adding a malicious DLL file to the load path the application searches for DLLs when loading, we can inject the malicious DLL where the valid DLL was not found (”NAME NOT FOUND”). This results in the malicious DLL being called when the application is loaded.

[Service Binary Path](https://github.com/KaminoSec/windows_privesc/tree/main/service_bin_path): Service permission binary path exploitation involves locating services where our user has write access to the SERVICE_CHANGE_CONFIG. This access permission means we can overwrite the binary path (BINARY_PATH_NAME) with malicious commands, such as adding our user to the administrators local group.
